{{/* layouts/partials/related-sidebar-trending.html */}}

{{ $all := where .Site.RegularPages "Section" "recipes" }}
{{ $items := where $all "RelPermalink" "ne" .RelPermalink }}

{{/* trending = les plus récents pour l’instant */}}
{{ $items = first 7 (sort $items "Date" "desc") }}

{{ if gt (len $items) 0 }}
<div class="card bg-white/95 md:bg-gradient-to-br md:from-white/80 md:to-gray-50/60 border border-slate-200/50 shadow-lg md:shadow-xl rounded-2xl md:rounded-3xl p-4 md:p-6">

  <!-- HEADER -->
  <div class="text-center">
    <h3 class="text-sm md:text-base font-semibold tracking-widest uppercase"
        style="color: var(--color-text); font-family: var(--font-serif); letter-spacing: .18em;">
      People Love
    </h3>
    <div class="mx-auto mt-3 h-[2px] w-20 rounded-full"
         style="background: linear-gradient(90deg, transparent, #e5b95b, transparent);"></div>
  </div>

  <div class="mt-6 space-y-6">
    {{ range $items }}
      <a href="{{ .RelPermalink }}" class="block group">
        <article class="relative overflow-hidden rounded-2xl border border-slate-200/60 bg-white shadow-sm">

          {{ with .Params.image }}
            <div class="relative aspect-[4/5] overflow-hidden">
              {{ partial "recipe-image.html" (dict "image" . "title" $.Title "variant" "sidebar") }}

              <!-- Overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>

              <!-- Category pill -->
              {{ with index (.Params.categories | default (slice)) 0 }}
                <div class="absolute top-4 left-1/2 -translate-x-1/2">
                  <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-xs font-semibold uppercase tracking-wider"
                        style="background: rgba(255,255,255,.18); color: white; border: 1px solid rgba(255,255,255,.25); backdrop-filter: blur(8px);">
                    <span class="inline-block w-2 h-2 rounded-full bg-white/80"></span>
                    {{ . }}
                  </span>
                </div>
              {{ end }}

              <!-- Title + meta -->
              <div class="absolute inset-x-0 bottom-0 p-5 text-center">
                <h4 class="text-2xl md:text-3xl font-extrabold leading-tight"
                    style="color: white; font-family: var(--font-serif); text-shadow: 0 6px 18px rgba(0,0,0,.35);">
                  {{ .Title }}
                </h4>

                {{ if .Date }}
                  <p class="mt-3 text-sm italic text-white/85"
                     style="font-family: var(--font-serif);">
                    {{ .Date.Format "January 2, 2006" }} <span class="opacity-70">—</span>
                    <span class="not-italic">4 Mins read</span>
                  </p>
                {{ end }}
              </div>
            </div>
          {{ end }}

        </article>
      </a>
    {{ end }}
  </div>

</div>
{{ end }}
